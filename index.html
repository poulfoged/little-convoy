<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>LittleConvoy by poulfoged</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>LittleConvoy</h1>
        <p>LittleConvoy is meant as a drop-in replacement for your existing JsonP requests that provides progression callbacks</p>

        <p class="view"><a href="https://github.com/poulfoged/little-convoy">View the Project on GitHub <small>poulfoged/little-convoy</small></a></p>


        <ul>
          <li><a href="https://github.com/poulfoged/little-convoy/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/poulfoged/little-convoy/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/poulfoged/little-convoy">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><img src="https://raw.github.com/poulfoged/little-convoy/master/graphics/LittleConvoy%20Logo.png"></p>

<p><em>Drop-in replacement for your existing JsonP requests that provides progression callbacks.</em></p>

<h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>When performing cross-server JSONP requests today, there is little feedback on progress, timeouts and other errors.
Also there is limits to the amount of data that can be send when it all has to be packed into the request querystring.</p>

<p>This library provides server requests via real posts to a hidden frame and uses HTTP/1.1 chunked transfer encoding to
provide progression events duing send.</p>

<h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<ul>
<li>.NET 4.0+ (reporting via HTTP available via <code>LittleConvoyActionAttribute</code> class)</li>
<li>ASP.NET MVC 3+</li>
</ul><h2>
<a name="how-to-use" class="anchor" href="#how-to-use"><span class="octicon octicon-link"></span></a>How To Use</h2>

<p><strong>First</strong>, specify LittleConvoy as a dependency:</p>

<p>PM&gt; Install-Package LittleConvoy</p>

<p><strong>Second</strong>, take your exiting JSON emitting controller methods and decorate them with this attribute:</p>

<div class="highlight highlight-csharp"><pre><span class="k">using</span> <span class="nn">LittleConvoy.TestSite.Utilities</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">LittleConvoy.TestSite.Controllers</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">class</span> <span class="nc">DemoController</span> <span class="p">:</span> <span class="n">Controller</span>
  <span class="p">{</span>
<span class="na">    [LittleConvoyAction(StartPercent = 0)]</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Echo</span><span class="p">(</span><span class="kt">object</span> <span class="n">source</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">JsonNetResult</span> <span class="p">{</span><span class="n">Data</span> <span class="p">=</span> <span class="n">source</span><span class="p">,</span> <span class="n">JsonRequestBehavior</span> <span class="p">=</span> <span class="n">JsonRequestBehavior</span><span class="p">.</span><span class="n">AllowGet</span><span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>After that add the client to your project (included in the package) via require or by including build/client.js
and calling it from JavaScript:</p>

<div class="highlight highlight-javascript"><pre><span class="k">new</span> <span class="nx">clientLib</span><span class="p">.</span><span class="nx">LittleConvoy</span><span class="p">.</span><span class="nx">Client</span><span class="p">(</span><span class="s1">'HiddenFrame'</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">'http://littleconvoy.devchamp.com/demo/echo'</span><span class="p">,</span> <span class="nx">delay</span><span class="o">:</span> <span class="mi">0</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">Hello</span><span class="o">:</span> <span class="s1">'World'</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">progressed</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">progress</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Progress from server: '</span> <span class="o">+</span> <span class="nx">progress</span> <span class="o">+</span> <span class="s1">'%'</span><span class="p">);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Done, recieved data: '</span> <span class="o">+</span> <span class="nx">data</span><span class="p">)</span>
   <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">alert</span><span class="p">(</span><span class="s1">'unable to contact server:\n'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">);</span>
    <span class="p">});</span>
</pre></div>

<p>The string 'HiddenFrame' is the selected transport, only HiddenFrame is available for now.</p>

<p>Note that the default number of progression callbacks is 10. Hello world is the data that is send to the server. </p>

<p>POST/GET method can be specified, default is POST.</p>

<p>The Library contains a small Promise library which can easy be converted to the promise lib of your choice. The dealy parameter can be used for 
debugging purposes, adding a number of milliseconds on the server side for each request.</p>

<h2>
<a name="known-limitations" class="anchor" href="#known-limitations"><span class="octicon octicon-link"></span></a>Known limitations</h2>

<ul>
<li>Only works in Internet Explorer 10+ for now, 8 &amp; 9 is work in progress.</li>
<li>There is a ~600 bytes overhead compared to classic JSONP requests </li>
<li>The send request with the chunked http is a hack in the ASPNET MVC pipeline, so if you are using other custom MVC filters they may fail. 
That said, Microsoft Internet Information Server does not seem to care and any pipeline modules like gzip/deflate compression still works.</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/poulfoged">poulfoged</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>